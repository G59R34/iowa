<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="cornclubfavicon.png">
    <link rel="shortcut icon" type="image/png" href="cornclubfavicon.png">
    <title>üèÜ LEGENDARY Tesla Supercharger - Ultra Study Level</title>
    <link rel="stylesheet" href="style.css">
    <script src="global-nav.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0c0c0c, #1a1a1a, #2d2d2d);
            color: #00ff88;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Background */
        .legendary-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 255, 136, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(255, 107, 107, 0.05) 0%, transparent 50%);
            animation: legendaryPulse 8s ease-in-out infinite;
            z-index: -2;
        }

        @keyframes legendaryPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Floating Particles */
        .particle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: #ffd700;
            border-radius: 50%;
            animation: floatParticle 15s linear infinite;
            z-index: -1;
        }

        @keyframes floatParticle {
            0% {
                transform: translateY(100vh) translateX(0px);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        /* Complex Math Challenge */
        .legendary-gate {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid #ffd700;
            border-radius: 20px;
            margin: 40px auto;
            max-width: 900px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            animation: gateGlow 3s ease-in-out infinite;
        }

        @keyframes gateGlow {
            0%, 100% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 0 80px rgba(255, 215, 0, 0.6); }
        }

        .legendary-title {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #ffd700, #ffed4e, #fff700);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
            margin-bottom: 20px;
            animation: titleShimmer 2s ease-in-out infinite;
        }

        @keyframes titleShimmer {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .equation-container {
            background: rgba(0, 0, 0, 0.6);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #00ff88;
            margin: 20px 0;
            font-size: 1.2rem;
        }

        .complex-equation {
            font-family: 'Times New Roman', serif;
            font-size: 1.4rem;
            line-height: 2;
            color: #ffffff;
            margin: 20px 0;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .math-input-section {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .input-group {
            background: rgba(255, 215, 0, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ffd700;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #ffd700;
        }

        .math-input {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff88;
            border-radius: 8px;
            color: #00ff88;
            font-size: 1.1rem;
            font-family: 'Courier New', monospace;
            text-align: center;
        }

        .math-input:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }

        .legendary-submit {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border: none;
            color: #000;
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            text-transform: uppercase;
        }

        .legendary-submit:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        }

        .legendary-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Progress Indicators */
        .progress-container {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            gap: 10px;
        }

        .progress-step {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #333;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.5s ease;
        }

        .progress-step.completed {
            background: rgba(0, 255, 136, 0.2);
            border-color: #00ff88;
            color: #00ff88;
        }

        .progress-step.current {
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
            color: #ffd700;
            animation: currentStepPulse 2s ease-in-out infinite;
        }

        @keyframes currentStepPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Legendary Supercharger Section */
        .legendary-supercharger {
            display: none;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.9);
            border: 3px solid #ffd700;
            border-radius: 20px;
            margin: 20px;
            position: relative;
            overflow: hidden;
        }

        .legendary-supercharger::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: legendaryShine 3s linear infinite;
        }

        @keyframes legendaryShine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .legendary-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }

        .legendary-header h1 {
            font-size: 3rem;
            background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4, #45b7d1);
            background-size: 400% 400%;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: legendaryGradient 4s ease infinite;
        }

        @keyframes legendaryGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Enhanced Game Grid */
        .legendary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
            position: relative;
            z-index: 1;
        }

        .grid-section {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff88;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .grid-section:hover {
            border-color: #ffd700;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
        }

        /* Enhanced Interactive Elements */
        .legendary-tesla {
            width: 120px;
            height: 60px;
            background: linear-gradient(45deg, #1e3c72, #2a5298);
            border-radius: 10px;
            margin: 15px auto;
            position: relative;
            cursor: move;
            transition: all 0.3s ease;
            border: 2px solid #00ff88;
        }

        .legendary-tesla:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .legendary-tesla.dragging {
            transform: scale(1.2) rotate(5deg);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        }

        /* Status Displays */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
            position: relative;
            z-index: 1;
        }

        .status-panel {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ff88;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .status-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
            margin: 10px 0;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        /* Enhanced Animations */
        .legendary-charging {
            animation: legendaryChargePulse 1s ease-in-out infinite;
        }

        @keyframes legendaryChargePulse {
            0%, 100% {
                border-color: #00ff88;
                box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            }
            50% {
                border-color: #ffd700;
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
            }
        }

        /* Legendary Effects */
        .legendary-explosion {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.8), rgba(255, 107, 107, 0.6), transparent);
            display: none;
            z-index: 9999;
            animation: legendaryBoom 3s ease-out;
        }

        @keyframes legendaryBoom {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            50% {
                transform: scale(1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .math-input-section {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .legendary-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .legendary-title {
                font-size: 2rem;
            }
            
            .legendary-header h1 {
                font-size: 2.2rem;
            }
        }

        /* Easter Egg Styles */
        .legendary-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 30px;
            z-index: 10000;
            max-width: 500px;
            text-align: center;
            animation: notificationAppear 0.5s ease-out;
        }

        @keyframes notificationAppear {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .notification-title {
            font-size: 1.5rem;
            color: #ffd700;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .notification-message {
            color: #ffffff;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .notification-close {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .notification-close:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="legendary-bg"></div>

    <!-- Floating Particles -->
    <div id="particles-container"></div>

        <!-- Hidden Math Cheat Sheet (Double-click to reveal) -->
        <div class="math-cheat-sheet" ondblclick="revealMathAnswers()" style="position: fixed; top: 20px; left: 20px; width: 15px; height: 15px; background: rgba(255,215,0,0.1); border: 1px solid rgba(255,215,0,0.2); border-radius: 3px; cursor: pointer; z-index: 100; opacity: 0.3;" title="Double-click for math hints">
            <div style="font-size: 8px; text-align: center; color: #ffd700; line-height: 15px;">üìù</div>
        </div>
        
        <div id="math-answers-popup" style="display: none; position: fixed; top: 50px; left: 20px; background: rgba(0,0,0,0.95); border: 2px solid #ffd700; border-radius: 10px; padding: 20px; z-index: 101; font-family: monospace; font-size: 12px; color: #ffd700; max-width: 300px;">
            <div style="text-align: center; font-weight: bold; margin-bottom: 15px; color: #00ff88;">MATH CHEAT SHEET</div>
            <div style="margin-bottom: 10px;"><strong>Phase 1:</strong> 18.34, -2.22, 2.72</div>
            <div style="margin-bottom: 10px;"><strong>Phase 2:</strong> -15, 54, 6.2</div>
            <div style="margin-bottom: 10px;"><strong>Phase 3:</strong> 0.5328, 66.4, 2600</div>
            <div style="margin-bottom: 15px;"><strong>Elite Access:</strong> 4.67</div>
            <button onclick="document.getElementById('math-answers-popup').style.display='none'" style="background: #ff6b6b; border: none; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Close</button>
        </div>
        
        <!-- Hidden Math Skip Button (Hold for 3 seconds to activate) -->
        <div class="math-skip-button" onmousedown="startMathSkip()" onmouseup="stopMathSkip()" onmouseleave="stopMathSkip()" ontouchstart="startMathSkip()" ontouchend="stopMathSkip()" style="position: fixed; bottom: 20px; left: 20px; width: 20px; height: 20px; background: rgba(255,107,107,0.1); border: 1px solid rgba(255,107,107,0.2); border-radius: 50%; cursor: pointer; z-index: 100; opacity: 0.2;" title="Hold for 3 seconds to skip math" onmouseover="this.style.opacity='0.8'; this.style.background='rgba(255, 107, 107, 0.3)'; this.style.transform='scale(1.3)'" onmouseout="this.style.opacity='0.2'; this.style.background='rgba(255, 107, 107, 0.1)'; this.style.transform='scale(1)'">
            <div style="font-size: 10px; text-align: center; color: #ff6b6b; line-height: 20px;">‚è≠Ô∏è</div>
            <div class="skip-progress" style="position: absolute; top: -2px; left: -2px; width: 24px; height: 24px; border: 2px solid transparent; border-radius: 50%; transition: all 0.1s ease;"></div>
        </div>

        <!-- Complex Mathematical Gate -->
        <div class="legendary-gate">
            <h1 class="legendary-title">üèÜ LEGENDARY TESLA SUPERCHARGER ACCESS üèÜ</h1>
            <p style="margin-bottom: 30px; font-size: 1.1rem;">
                Only those who master the ancient art of advanced mathematics may proceed...
            </p>        <div class="progress-container">
            <div class="progress-step current" id="step1">
                <div>üìê Calculus</div>
                <small>Derivative & Integral</small>
            </div>
            <div class="progress-step" id="step2">
                <div>üî¢ Linear Algebra</div>
                <small>Matrix Operations</small>
            </div>
            <div class="progress-step" id="step3">
                <div>üìä Statistics</div>
                <small>Probability Theory</small>
            </div>
        </div>

        <!-- Phase 1: Calculus Challenge -->
        <div class="equation-container" id="phase1">
            <h3 style="color: #ffd700; margin-bottom: 20px;">Phase 1: Advanced Calculus</h3>
            <div class="complex-equation">
                Find: ‚à´‚ÇÄ^œÄ [sin(3x)¬∑cos(x) + e^(x/2)¬∑ln(x+1)] dx
            </div>
            <div class="math-input-section">
                <div class="input-group">
                    <label>Integral Result (rounded to 2 decimal places):</label>
                    <input type="number" step="0.01" class="math-input" id="calculus-answer" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label>Derivative of f(x) = x¬≥¬∑sin(2x) at x=œÄ/4:</label>
                    <input type="number" step="0.01" class="math-input" id="derivative-answer" placeholder="0.00">
                </div>
                <div class="input-group">
                    <label>Limit as x‚Üí‚àû of (1 + 1/x)^x:</label>
                    <input type="number" step="0.01" class="math-input" id="limit-answer" placeholder="0.00">
                </div>
            </div>
            <button class="legendary-submit" onclick="checkPhase1()">Submit Calculus Solutions</button>
        </div>

        <!-- Phase 2: Linear Algebra Challenge (Hidden) -->
        <div class="equation-container" id="phase2" style="display: none;">
            <h3 style="color: #ffd700; margin-bottom: 20px;">Phase 2: Linear Algebra Mastery</h3>
            <div class="complex-equation">
                Given Matrix A = [[2, 1, 3], [1, 4, 2], [3, 2, 1]]<br>
                Calculate: det(A) + tr(A¬≤) - eigenvalue_max(A)
            </div>
            <div class="math-input-section">
                <div class="input-group">
                    <label>Determinant of Matrix A:</label>
                    <input type="number" class="math-input" id="determinant-answer" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Trace of A¬≤ (sum of diagonal elements):</label>
                    <input type="number" class="math-input" id="trace-answer" placeholder="0">
                </div>
                <div class="input-group">
                    <label>Largest Eigenvalue (rounded to 1 decimal):</label>
                    <input type="number" step="0.1" class="math-input" id="eigenvalue-answer" placeholder="0.0">
                </div>
            </div>
            <button class="legendary-submit" onclick="checkPhase2()">Submit Matrix Solutions</button>
        </div>

        <!-- Phase 3: Statistics Challenge (Hidden) -->
        <div class="equation-container" id="phase3" style="display: none;">
            <h3 style="color: #ffd700; margin-bottom: 20px;">Phase 3: Statistical Enlightenment</h3>
            <div class="complex-equation">
                Normal Distribution Œº=50, œÉ=10<br>
                Find: P(45 < X < 60) + Œ¶‚Åª¬π(0.95) - E[X¬≤]
            </div>
            <div class="math-input-section">
                <div class="input-group">
                    <label>Probability P(45 < X < 60) (4 decimal places):</label>
                    <input type="number" step="0.0001" class="math-input" id="probability-answer" placeholder="0.0000">
                </div>
                <div class="input-group">
                    <label>95th Percentile Value (1 decimal place):</label>
                    <input type="number" step="0.1" class="math-input" id="percentile-answer" placeholder="0.0">
                </div>
                <div class="input-group">
                    <label>Expected Value of X¬≤ (E[X¬≤]):</label>
                    <input type="number" class="math-input" id="expectation-answer" placeholder="0">
                </div>
            </div>
            <button class="legendary-submit" onclick="checkPhase3()">Complete Final Challenge</button>
        </div>

        <div id="math-feedback" style="margin-top: 20px;"></div>
    </div>

    <!-- Legendary Tesla Supercharger Interface -->
    <div class="legendary-supercharger" id="legendary-interface">
        <div class="legendary-header">
            <h1>üèÜ LEGENDARY TESLA SUPERCHARGER STATION üèÜ</h1>
            <p>The Most Advanced Charging Experience in the Known Universe</p>
        </div>

        <!-- Simplified Control Panel -->
        <div style="display: flex; justify-content: center; gap: 40px; margin: 40px 0; flex-wrap: wrap;">
            <!-- Step 1: Tesla Deployment -->
            <div class="control-panel" style="background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(30,60,114,0.2)); border: 3px solid #4ecdc4; border-radius: 20px; padding: 30px; text-align: center; min-width: 280px; box-shadow: 0 0 30px rgba(78, 205, 196, 0.4);">
                <h2 style="color: #4ecdc4; margin-bottom: 20px; text-shadow: 0 0 15px #4ecdc4;">STEP 1: Deploy Tesla</h2>
                <div class="legendary-tesla" id="legendary-tesla" draggable="true" style="width: 160px; height: 80px; background: linear-gradient(45deg, #1e3c72, #2a5298, #4ecdc4); border-radius: 20px; margin: 20px auto; position: relative; cursor: move; transition: all 0.3s ease; border: 4px solid #4ecdc4; box-shadow: 0 0 20px rgba(78, 205, 196, 0.6);">
                    <img src="tesla-model-s.png" alt="Tesla Model S" style="width: 100%; height: 100%; object-fit: contain; border-radius: 16px;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none; color: #4ecdc4; font-weight: bold; text-shadow: 0 0 10px #4ecdc4; font-size: 1.2rem;">üöó CYBER TESLA</div>
                </div>
                <p style="color: #4ecdc4; font-size: 1.1rem; font-weight: bold;">Drag Tesla to Parking Zone ‚Üì</p>
            </div>

            <!-- Step 2: Parking Zone -->
            <div class="control-panel" id="legendary-parking" style="background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(255,215,0,0.1)); border: 3px solid #ffd700; border-radius: 20px; padding: 30px; text-align: center; min-width: 280px; box-shadow: 0 0 30px rgba(255, 215, 0, 0.4);">
                <h2 style="color: #ffd700; margin-bottom: 20px; text-shadow: 0 0 15px #ffd700;">STEP 2: Park Tesla</h2>
                <div style="height: 120px; border: 4px dashed #ffd700; border-radius: 20px; display: flex; align-items: center; justify-content: center; background: radial-gradient(circle, rgba(255,215,0,0.2), transparent); position: relative; overflow: hidden; margin: 20px 0;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,215,0,0.1) 10px, rgba(255,215,0,0.1) 20px); animation: parkingLines 3s linear infinite;"></div>
                    <span id="parking-status" style="position: relative; z-index: 1; color: #ffd700; font-weight: bold; text-shadow: 0 0 8px #ffd700; font-size: 1.2rem;">üÖøÔ∏è PARKING ZONE</span>
                </div>
                <p style="color: #ffd700; font-size: 1.1rem; font-weight: bold;">Drop Zone Ready</p>
            </div>

            <!-- Step 3: Quantum Charger -->
            <div class="control-panel" style="background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(255,107,107,0.2)); border: 3px solid #ff6b6b; border-radius: 20px; padding: 30px; text-align: center; min-width: 280px; box-shadow: 0 0 30px rgba(255, 107, 107, 0.4);">
                <h2 style="color: #ff6b6b; margin-bottom: 20px; text-shadow: 0 0 15px #ff6b6b;">STEP 3: Connect Charger</h2>
                <div id="legendary-charger" style="height: 120px; background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4); border-radius: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; overflow: hidden; border: 4px solid #ff6b6b; box-shadow: 0 0 20px rgba(255, 107, 107, 0.6); margin: 20px 0;" onclick="connectQuantumCharger()">
                    <img src="supercharger-station.png" alt="Supercharger Station" style="width: 80px; height: 80px; object-fit: contain;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div style="display: none; color: white; font-weight: bold; text-shadow: 0 0 10px rgba(255,255,255,0.8); font-size: 1.2rem;">‚ö° QUANTUM LINK</div>
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: chargerSweep 2s ease-in-out infinite;"></div>
                </div>
                <p style="color: #ff6b6b; font-size: 1.1rem; font-weight: bold;">Click to Connect</p>
            </div>
        </div>

            <!-- Neural Banking Interface -->
            <div class="grid-section">
                <h3>üß† Neural Banking AI</h3>
                <div style="background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 8px;">
                    <div>Balance: <span id="legendary-balance">$‚àû</span></div>
                    <div>Status: <span id="banking-status">UNLIMITED</span></div>
                </div>
            </div>

            <!-- Multidimensional Battery -->
            <div class="grid-section">
                <h3>üîã Multidimensional Battery</h3>
                <div style="position: relative;">
                    <div style="width: 100%; height: 20px; background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden;">
                        <div id="legendary-battery-fill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #00ff88, #ffd700, #ff6b6b); transition: width 0.5s ease;"></div>
                    </div>
                    <div id="battery-percentage" style="margin-top: 10px;">0%</div>
                </div>
            </div>

            <!-- Chaos Control Panel -->
            <div class="grid-section">
                <h3>üåÄ Chaos Control Matrix</h3>
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button style="padding: 8px 12px; background: #ff6b6b; border: none; border-radius: 6px; color: white; cursor: pointer;" onclick="triggerChaosMode()">CHAOS</button>
                    <button style="padding: 8px 12px; background: #4ecdc4; border: none; border-radius: 6px; color: white; cursor: pointer;" onclick="triggerTimeWarp()">TIME WARP</button>
                    <button style="padding: 8px 12px; background: #ffd700; border: none; border-radius: 6px; color: black; cursor: pointer;" onclick="triggerQuantumLeap()">QUANTUM LEAP</button>
                </div>
            </div>
        </div>

        <!-- Holographic Tesla Projection -->
        <div class="hologram-container" style="text-align: center; margin: 40px 0; background: rgba(0,0,0,0.8); border: 2px solid #4ecdc4; border-radius: 15px; padding: 30px; position: relative; overflow: hidden;">
            <h3 style="color: #4ecdc4; margin-bottom: 20px;">üåü Holographic Tesla Projection</h3>
            <div class="hologram-tesla" id="hologram-tesla" onclick="cycleHologramMode()" style="width: 200px; height: 100px; margin: 0 auto; background: linear-gradient(45deg, rgba(78, 205, 196, 0.3), rgba(255, 215, 0, 0.2)); border: 2px solid #4ecdc4; border-radius: 15px; position: relative; cursor: pointer; transform-style: preserve-3d; animation: hologramFloat 4s ease-in-out infinite;">
                <div class="hologram-lines" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(78, 205, 196, 0.2) 2px, rgba(78, 205, 196, 0.2) 4px); animation: hologramScan 2s linear infinite;"></div>
                <div class="tesla-hologram-text" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #4ecdc4; font-weight: bold; text-shadow: 0 0 10px #4ecdc4;">üöó CYBER</div>
            </div>
            <p style="margin-top: 15px; color: #4ecdc4;">Click to cycle hologram modes</p>
            <div class="hologram-controls" style="margin-top: 20px; display: flex; justify-content: center; gap: 15px;">
                <button onclick="rotateHologram()" style="background: rgba(78, 205, 196, 0.2); border: 1px solid #4ecdc4; color: #4ecdc4; padding: 8px 15px; border-radius: 8px; cursor: pointer;">‚Üª Rotate</button>
                <button onclick="changeHologramColor()" style="background: rgba(78, 205, 196, 0.2); border: 1px solid #4ecdc4; color: #4ecdc4; padding: 8px 15px; border-radius: 8px; cursor: pointer;">üé® Color</button>
                <button onclick="hologramGlitch()" style="background: rgba(78, 205, 196, 0.2); border: 1px solid #4ecdc4; color: #4ecdc4; padding: 8px 15px; border-radius: 8px; cursor: pointer;">‚ö° Glitch</button>
            </div>
        </div>

        <!-- Simplified Status Dashboard -->
        <div style="background: rgba(0,0,0,0.8); border: 2px solid #00ff88; border-radius: 15px; padding: 20px; margin: 30px auto; max-width: 800px; text-align: center;">
            <h3 style="color: #00ff88; margin-bottom: 20px; text-shadow: 0 0 10px #00ff88;">LEGENDARY TESLA STATUS</h3>
            <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px;">
                <div style="background: rgba(0,255,136,0.1); padding: 15px; border-radius: 10px; border: 1px solid #00ff88;">
                    <div style="color: #00ff88; font-size: 0.9rem;">‚ö° Power</div>
                    <div style="color: #ffd700; font-size: 1.5rem; font-weight: bold;" id="power-output">0 QW</div>
                </div>
                <div style="background: rgba(0,255,136,0.1); padding: 15px; border-radius: 10px; border: 1px solid #00ff88;">
                    <div style="color: #00ff88; font-size: 0.9rem;">üîã Battery</div>
                    <div style="color: #ffd700; font-size: 1.5rem; font-weight: bold;" id="battery-percentage">0%</div>
                </div>
                <div style="background: rgba(0,255,136,0.1); padding: 15px; border-radius: 10px; border: 1px solid #00ff88;">
                    <div style="color: #00ff88; font-size: 0.9rem;">üåÄ Flux</div>
                    <div style="color: #ffd700; font-size: 1.5rem; font-weight: bold;" id="quantum-flux">STABLE</div>
                </div>
                <div style="background: rgba(0,255,136,0.1); padding: 15px; border-radius: 10px; border: 1px solid #00ff88;">
                    <div style="color: #00ff88; font-size: 0.9rem;">üéØ Efficiency</div>
                    <div style="color: #ffd700; font-size: 1.5rem; font-weight: bold;" id="efficiency-rating">‚àû%</div>
                </div>
            </div>
        </div>

        <!-- Weather Control Panel -->
        <div class="weather-control" style="background: rgba(0,0,0,0.8); border: 2px solid #45b7d1; border-radius: 15px; padding: 25px; margin: 30px 0; text-align: center;">
            <h3 style="color: #45b7d1; margin-bottom: 20px;">üå§Ô∏è Atmospheric Control Matrix</h3>
            <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                <button onclick="activateWeather('rain')" style="background: linear-gradient(45deg, #4a90e2, #357abd); border: none; color: white; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold;">üåßÔ∏è Rain</button>
                <button onclick="activateWeather('snow')" style="background: linear-gradient(45deg, #e6f3ff, #b3d9ff); border: none; color: #333; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold;">‚ùÑÔ∏è Snow</button>
                <button onclick="activateWeather('lightning')" style="background: linear-gradient(45deg, #ffd700, #ffed4e); border: none; color: #333; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold;">‚ö° Lightning</button>
                <button onclick="activateWeather('aurora')" style="background: linear-gradient(45deg, #00ff88, #4ecdc4); border: none; color: #333; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold;">üåå Aurora</button>
                <button onclick="activateWeather('clear')" style="background: linear-gradient(45deg, #ff6b6b, #ee5a52); border: none; color: white; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold;">‚òÄÔ∏è Clear</button>
            </div>
            <div id="weather-status" style="margin-top: 15px; color: #45b7d1; font-weight: bold;">Current: Clear Skies</div>
        </div>

        <!-- Portal System -->
        <div class="portal-system" style="background: rgba(0,0,0,0.8); border: 2px solid #9b59b6; border-radius: 15px; padding: 25px; margin: 30px 0; text-align: center; position: relative;">
            <h3 style="color: #9b59b6; margin-bottom: 20px;">üåÄ Interdimensional Portal Network</h3>
            <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                <button onclick="openPortal('dimension1')" style="background: radial-gradient(circle, #9b59b6, #8e44ad); border: none; color: white; padding: 15px; border-radius: 50%; width: 80px; height: 80px; cursor: pointer; font-size: 1.5rem; animation: portalPulse 2s ease-in-out infinite;">üåÄ</button>
                <button onclick="openPortal('dimension2')" style="background: radial-gradient(circle, #e74c3c, #c0392b); border: none; color: white; padding: 15px; border-radius: 50%; width: 80px; height: 80px; cursor: pointer; font-size: 1.5rem; animation: portalPulse 2s ease-in-out infinite 0.5s;">üî•</button>
                <button onclick="openPortal('dimension3')" style="background: radial-gradient(circle, #3498db, #2980b9); border: none; color: white; padding: 15px; border-radius: 50%; width: 80px; height: 80px; cursor: pointer; font-size: 1.5rem; animation: portalPulse 2s ease-in-out infinite 1s;">‚ùÑÔ∏è</button>
            </div>
            <div id="portal-status" style="margin-top: 15px; color: #9b59b6;">Portals: Inactive</div>
        </div>

        <!-- AI Assistant Panel -->
        <div class="ai-assistant" style="background: rgba(0,0,0,0.9); border: 2px solid #e67e22; border-radius: 15px; padding: 25px; margin: 30px 0; position: relative;">
            <h3 style="color: #e67e22; margin-bottom: 20px;">ü§ñ ARIA - Autonomous Response & Intelligence Assistant</h3>
            <div class="ai-display" style="background: rgba(0,0,0,0.5); border: 1px solid #e67e22; border-radius: 10px; padding: 20px; min-height: 100px; margin-bottom: 20px;">
                <div id="ai-message" style="color: #e67e22; font-family: 'Courier New', monospace; line-height: 1.5;">ARIA: Hello, human. I am monitoring your supercharger activities with mild interest...</div>
            </div>
            <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                <button onclick="askAI('opinion')" style="background: rgba(230, 126, 34, 0.2); border: 1px solid #e67e22; color: #e67e22; padding: 8px 15px; border-radius: 8px; cursor: pointer;">üí≠ Opinion</button>
                <button onclick="askAI('sarcasm')" style="background: rgba(230, 126, 34, 0.2); border: 1px solid #e67e22; color: #e67e22; padding: 8px 15px; border-radius: 8px; cursor: pointer;">üòè Sarcasm</button>
                <button onclick="askAI('wisdom')" style="background: rgba(230, 126, 34, 0.2); border: 1px solid #e67e22; color: #e67e22; padding: 8px 15px; border-radius: 8px; cursor: pointer;">üß† Wisdom</button>
                <button onclick="askAI('chaos')" style="background: rgba(230, 126, 34, 0.2); border: 1px solid #e67e22; color: #e67e22; padding: 8px 15px; border-radius: 8px; cursor: pointer;">üå™Ô∏è Chaos</button>
            </div>
        </div>

        <!-- Master Control -->
        <div style="text-align: center; margin-top: 40px;">
            <button class="legendary-submit" id="master-control" style="font-size: 1.5rem; padding: 20px 50px;" onclick="initiateLegendaryCharging()" disabled>
                üöÄ INITIATE LEGENDARY CHARGING SEQUENCE üöÄ
            </button>
        </div>
    </div>

    <!-- Legendary Explosion Overlay -->
    <div class="legendary-explosion" id="legendary-explosion"></div>

    <!-- Audio Elements -->
    <audio id="legendary-sound" preload="auto">
        <source src="res/aud/cat/cat-meow.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="tesla-whip-sound" preload="auto">
        <source src="res/aud/supercharger/Explosion.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Game State
        let currentPhase = 1;
        let mathCompleted = false;
        let teslaParked = false;
        let chargerConnected = false;
        let chargingActive = false;
        let chaosLevel = 0;
        let easterEggCount = 0;
        
        // New Feature States
        let hologramMode = 'cyber';
        let hologramRotation = 0;
        let currentWeather = 'clear';
        let portalActive = false;
        let aiPersonality = 'sassy';
        let godModeActive = false;
        
        // Konami Code Detection
        let konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'];
        let konamiInput = [];
        
        // Weather Systems
        const weatherEffects = {
            rain: { particles: 'üíß', count: 50, animation: 'fall' },
            snow: { particles: '‚ùÑÔ∏è', count: 30, animation: 'drift' },
            lightning: { particles: '‚ö°', count: 5, animation: 'flash' },
            aurora: { particles: 'üåü', count: 20, animation: 'wave' },
            clear: { particles: null, count: 0, animation: 'none' }
        };
        
        // Correct Answers (Pre-calculated)
        const correctAnswers = {
            phase1: {
                calculus: 18.34,     // Integral result
                derivative: -2.22,   // Derivative at œÄ/4
                limit: 2.72         // e (Euler's number)
            },
            phase2: {
                determinant: -15,    // det(A)
                trace: 54,           // tr(A¬≤)
                eigenvalue: 6.2      // Largest eigenvalue
            },
            phase3: {
                probability: 0.5328, // P(45 < X < 60)
                percentile: 66.4,    // 95th percentile
                expectation: 2600    // E[X¬≤] = Œº¬≤ + œÉ¬≤
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            createFloatingParticles();
            setupDragAndDrop();
            startAmbientEffects();
            setupKonamiCode();
            
            // Initialize AI Assistant
            setTimeout(() => {
                typeWriterEffect(document.getElementById('ai-message'), 'ARIA: Systems online. Monitoring legendary activities...');
            }, 2000);
            
            // Play legendary entrance sound
            setTimeout(() => {
                playLegendarySound();
            }, 1000);
            
            // Add initial hologram animation
            setTimeout(() => {
                const hologram = document.getElementById('hologram-tesla');
                if (hologram) {
                    hologram.style.transition = 'all 0.5s ease';
                }
            }, 3000);
        });

        function createFloatingParticles() {
            const container = document.getElementById('particles-container');
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                
                // Random particle colors
                const colors = ['#ffd700', '#00ff88', '#ff6b6b', '#4ecdc4'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                container.appendChild(particle);
            }
        }

        function checkPhase1() {
            const calculus = parseFloat(document.getElementById('calculus-answer').value);
            const derivative = parseFloat(document.getElementById('derivative-answer').value);
            const limit = parseFloat(document.getElementById('limit-answer').value);
            
            const tolerance = 0.1;
            const feedback = document.getElementById('math-feedback');
            
            if (Math.abs(calculus - correctAnswers.phase1.calculus) < tolerance &&
                Math.abs(derivative - correctAnswers.phase1.derivative) < tolerance &&
                Math.abs(limit - correctAnswers.phase1.limit) < tolerance) {
                
                feedback.innerHTML = '<div style="color: #00ff88; font-weight: bold;">‚úÖ Phase 1 Complete! Advancing to Linear Algebra...</div>';
                
                // Progress to Phase 2
                document.getElementById('step1').classList.add('completed');
                document.getElementById('step1').classList.remove('current');
                document.getElementById('step2').classList.add('current');
                
                setTimeout(() => {
                    document.getElementById('phase1').style.display = 'none';
                    document.getElementById('phase2').style.display = 'block';
                    currentPhase = 2;
                }, 2000);
                
                triggerLegendaryEasterEgg('calculus');
            } else {
                feedback.innerHTML = '<div style="color: #ff6b6b;">‚ùå Incorrect. Hints: Use integration by parts, chain rule, and fundamental limits.</div>';
                shakeMathContainer();
            }
        }

        function checkPhase2() {
            const determinant = parseInt(document.getElementById('determinant-answer').value);
            const trace = parseInt(document.getElementById('trace-answer').value);
            const eigenvalue = parseFloat(document.getElementById('eigenvalue-answer').value);
            
            const feedback = document.getElementById('math-feedback');
            
            if (determinant === correctAnswers.phase2.determinant &&
                trace === correctAnswers.phase2.trace &&
                Math.abs(eigenvalue - correctAnswers.phase2.eigenvalue) < 0.2) {
                
                feedback.innerHTML = '<div style="color: #00ff88; font-weight: bold;">‚úÖ Phase 2 Complete! Proceeding to Final Statistical Challenge...</div>';
                
                // Progress to Phase 3
                document.getElementById('step2').classList.add('completed');
                document.getElementById('step2').classList.remove('current');
                document.getElementById('step3').classList.add('current');
                
                setTimeout(() => {
                    document.getElementById('phase2').style.display = 'none';
                    document.getElementById('phase3').style.display = 'block';
                    currentPhase = 3;
                }, 2000);
                
                triggerLegendaryEasterEgg('matrix');
            } else {
                feedback.innerHTML = '<div style="color: #ff6b6b;">‚ùå Matrix calculations incorrect. Review determinant expansion and eigenvalue computation.</div>';
                shakeMathContainer();
            }
        }

        function checkPhase3() {
            const probability = parseFloat(document.getElementById('probability-answer').value);
            const percentile = parseFloat(document.getElementById('percentile-answer').value);
            const expectation = parseInt(document.getElementById('expectation-answer').value);
            
            const feedback = document.getElementById('math-feedback');
            
            if (Math.abs(probability - correctAnswers.phase3.probability) < 0.01 &&
                Math.abs(percentile - correctAnswers.phase3.percentile) < 1 &&
                expectation === correctAnswers.phase3.expectation) {
                
                feedback.innerHTML = '<div style="color: #ffd700; font-weight: bold; font-size: 1.3rem;">üèÜ ALL PHASES COMPLETE! LEGENDARY ACCESS GRANTED! üèÜ</div>';
                
                // Complete all steps
                document.getElementById('step3').classList.add('completed');
                document.getElementById('step3').classList.remove('current');
                
                // Unlock legendary interface
                setTimeout(() => {
                    unlockLegendaryInterface();
                }, 3000);
                
                triggerLegendaryEasterEgg('mastery');
                mathCompleted = true;
            } else {
                feedback.innerHTML = '<div style="color: #ff6b6b;">‚ùå Statistical calculations need refinement. Check normal distribution properties.</div>';
                shakeMathContainer();
            }
        }

        function unlockLegendaryInterface() {
            document.querySelector('.legendary-gate').style.display = 'none';
            document.querySelector('.legendary-supercharger').style.display = 'block';
            
            // Epic entrance animation
            document.querySelector('.legendary-supercharger').style.transform = 'scale(0.8)';
            document.querySelector('.legendary-supercharger').style.opacity = '0';
            
            setTimeout(() => {
                document.querySelector('.legendary-supercharger').style.transform = 'scale(1)';
                document.querySelector('.legendary-supercharger').style.opacity = '1';
                document.querySelector('.legendary-supercharger').style.transition = 'all 1s ease';
            }, 100);
            
            showLegendaryNotification('üéâ LEGENDARY INTERFACE ACTIVATED üéâ', 'You have proven your mathematical prowess. The universe bows to your intellect.');
        }

        function setupDragAndDrop() {
            const tesla = document.getElementById('legendary-tesla');
            const parking = document.getElementById('legendary-parking');
            
            if (!tesla || !parking) return;
            
            tesla.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', 'tesla');
                tesla.classList.add('dragging');
            });
            
            tesla.addEventListener('dragend', () => {
                tesla.classList.remove('dragging');
            });
            
            parking.addEventListener('dragover', (e) => {
                e.preventDefault();
            });
            
            parking.addEventListener('drop', (e) => {
                e.preventDefault();
                const data = e.dataTransfer.getData('text/plain');
                
                if (data === 'tesla') {
                    parkLegendaryTesla();
                }
            });
        }

        function parkLegendaryTesla() {
            teslaParked = true;
            const tesla = document.getElementById('legendary-tesla');
            const status = document.getElementById('parking-status');
            
            tesla.style.display = 'none';
            status.textContent = 'üöó CYBER TESLA DEPLOYED';
            status.style.color = '#00ff88';
            
            document.getElementById('legendary-parking').style.borderColor = '#00ff88';
            document.getElementById('legendary-parking').classList.add('legendary-charging');
            
            checkReadiness();
            triggerLegendaryEasterEgg('parking');
        }

        function connectQuantumCharger() {
            if (!teslaParked) {
                showLegendaryNotification('‚ö†Ô∏è DEPLOYMENT REQUIRED', 'Deploy Cyber Tesla before connecting Quantum Charger.');
                return;
            }
            
            chargerConnected = true;
            document.getElementById('legendary-charger').innerHTML = '‚ö° QUANTUM LINKED';
            document.getElementById('legendary-charger').style.background = 'linear-gradient(45deg, #00ff88, #4ecdc4)';
            
            checkReadiness();
            triggerLegendaryEasterEgg('quantum');
        }

        function checkReadiness() {
            const masterControl = document.getElementById('master-control');
            
            if (teslaParked && chargerConnected) {
                masterControl.disabled = false;
                masterControl.style.background = 'linear-gradient(45deg, #ffd700, #ff6b6b)';
                masterControl.style.animation = 'legendaryPulse 2s ease-in-out infinite';
            }
        }

        function initiateLegendaryCharging() {
            if (!teslaParked || !chargerConnected) return;
            
            chargingActive = true;
            document.getElementById('master-control').textContent = '‚ö° LEGENDARY CHARGING ACTIVE ‚ö°';
            document.getElementById('master-control').disabled = true;
            
            startLegendaryCharging();
            triggerLegendaryEasterEgg('charging');
        }

        function startLegendaryCharging() {
            let batteryLevel = 0;
            let powerOutput = 0;
            let quantumFlux = 'STABLE';
            let overchargeLevel = 0;
            
            const chargingInterval = setInterval(() => {
                batteryLevel += Math.random() * 3 + 2;
                powerOutput = (Math.random() * 500 + 1000).toFixed(0);
                
                // Update displays
                const batteryFill = document.getElementById('legendary-battery-fill');
                const batteryPercent = document.getElementById('battery-percentage');
                const powerDisplay = document.getElementById('power-output');
                
                if (batteryFill) batteryFill.style.width = Math.min(batteryLevel, 100) + '%';
                if (batteryPercent) batteryPercent.textContent = Math.min(batteryLevel, 100).toFixed(1) + '%';
                if (powerDisplay) powerDisplay.textContent = powerOutput + ' QW';
                
                // Overcharge detection
                if (batteryLevel > 100) {
                    overchargeLevel = batteryLevel - 100;
                    
                    // Visual overcharge warning
                    if (batteryFill) {
                        batteryFill.style.background = 'linear-gradient(90deg, #ff0000, #ff6b6b, #ffffff)';
                        batteryFill.style.animation = 'overchargePulse 0.5s ease-in-out infinite';
                    }
                    
                    // Overcharge explosions at different levels
                    if (overchargeLevel > 10 && overchargeLevel < 12) {
                        explodeOriginalTesla();
                    }
                    if (overchargeLevel > 25 && overchargeLevel < 27) {
                        explodeSupercharger();
                    }
                }
                
                // Random quantum effects
                if (Math.random() < 0.1) {
                    const fluxStates = ['FLUCTUATING', 'HARMONIZED', 'RESONANT', 'CHAOTIC', 'OVERLOADING'];
                    quantumFlux = fluxStates[Math.floor(Math.random() * fluxStates.length)];
                    const fluxDisplay = document.getElementById('quantum-flux');
                    if (fluxDisplay) fluxDisplay.textContent = quantumFlux;
                }
                
                // Random legendary easter eggs during charging
                if (Math.random() < 0.05) {
                    triggerRandomLegendaryEffect();
                }
                
                // Complete charging at 150% (overcharged)
                if (batteryLevel >= 150) {
                    clearInterval(chargingInterval);
                    completeLegendaryCharging();
                }
            }, 200);
        }
        
        function explodeOriginalTesla() {
            const originalTesla = document.getElementById('legendary-tesla');
            if (originalTesla && !originalTesla.exploded) {
                originalTesla.exploded = true;
                
                showLegendaryNotification('üí• TESLA OVERLOAD EXPLOSION üí•', 'Original Tesla cannot handle the legendary power!');
                
                // Create explosion at Tesla location
                const teslaRect = originalTesla.getBoundingClientRect();
                createOverchargeExplosion(teslaRect.left, teslaRect.top, '#4ecdc4');
                
                // Transform Tesla
                originalTesla.style.animation = 'teslaOverloadExplode 2s ease-out forwards';
                
                playExplosionSound();
            }
        }
        
        function explodeSupercharger() {
            const supercharger = document.getElementById('legendary-charger');
            if (supercharger && !supercharger.exploded) {
                supercharger.exploded = true;
                
                showLegendaryNotification('‚ö° SUPERCHARGER MELTDOWN ‚ö°', 'Quantum charger cannot contain the legendary energy!');
                
                // Create explosion at charger location
                const chargerRect = supercharger.getBoundingClientRect();
                createOverchargeExplosion(chargerRect.left, chargerRect.top, '#ff6b6b');
                
                // Transform charger
                supercharger.style.animation = 'chargerMeltdown 3s ease-out forwards';
                
                playExplosionSound();
            }
        }
        
        function createOverchargeExplosion(x, y, color) {
            const explosion = document.createElement('div');
            explosion.style.cssText = `
                position: fixed;
                width: 200px;
                height: 200px;
                left: ${x - 100}px;
                top: ${y - 100}px;
                background: radial-gradient(circle, ${color}, #ffd700, transparent);
                border-radius: 50%;
                z-index: 2000;
                pointer-events: none;
                animation: overchargeExplosion 3s ease-out forwards;
            `;
            
            document.body.appendChild(explosion);
            
            // Screen shake
            document.body.style.animation = 'screenShake 1s ease-out';
            setTimeout(() => {
                document.body.style.animation = 'none';
            }, 1000);
            
            setTimeout(() => {
                if (explosion.parentNode) explosion.remove();
            }, 3000);
        }

        function completeLegendaryCharging() {
            showLegendaryNotification('üèÜ LEGENDARY CHARGING COMPLETE üèÜ', 'Initiating Tesla Armada Deployment Protocol...');
            
            // Start the massive Tesla whipping sequence
            setTimeout(() => {
                startMassiveTeslaWhipping();
            }, 1000);
        }
        
        function startMassiveTeslaWhipping() {
            showLegendaryNotification('‚ö° TESLA ARMADA DEPLOYED ‚ö°', '150+ Teslas materializing for ULTIMATE finale sequence!');
            
            // Create 150+ Tesla elements for whipping
            const teslaArmada = [];
            
            for (let i = 0; i < 155; i++) {
                setTimeout(() => {
                    const tesla = createWhippingTesla(i);
                    teslaArmada.push(tesla);
                    document.body.appendChild(tesla);
                    
                    // Start aggressive whipping immediately
                    startAggressiveTeslaWhipping(tesla, i);
                }, i * 100); // Faster stagger - 15.5 seconds total
            }
            
            // Store armada for global access
            window.teslaArmada = teslaArmada;
            
            // After 60 seconds, start individual explosions
            setTimeout(() => {
                startIndividualExplosions(teslaArmada);
            }, 60000);
        }
        
        function createWhippingTesla(index) {
            const tesla = document.createElement('div');
            tesla.className = 'whipping-tesla';
            tesla.id = `tesla-${index}`;
            
            const randomX = Math.random() * (window.innerWidth - 100);
            const randomY = Math.random() * (window.innerHeight - 60);
            
            tesla.style.cssText = `
                position: fixed;
                width: 80px;
                height: 40px;
                background: linear-gradient(45deg, #1e3c72, #2a5298, #4ecdc4);
                border: 2px solid #00ff88;
                border-radius: 8px;
                left: ${randomX}px;
                top: ${randomY}px;
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: center;
                color: #00ff88;
                font-size: 12px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
                transition: all 0.3s ease;
            `;
            
            // Try to use Tesla image, fallback to text
            tesla.innerHTML = `
                <img src="tesla-model-s.png" alt="Tesla" style="width: 100%; height: 100%; object-fit: contain; border-radius: 6px;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div style="display: none;">üöó ${index + 1}</div>
            `;
            
            // Click to explode early
            tesla.onclick = () => explodeTesla(tesla, index);
            
            return tesla;
        }
        
        function startAggressiveTeslaWhipping(tesla, index) {
            let whipDirectionX = Math.random() > 0.5 ? 1 : -1;
            let whipDirectionY = Math.random() > 0.5 ? 1 : -1;
            let whipSpeedX = Math.random() * 15 + 10; // 10-25px per frame (much faster)
            let whipSpeedY = Math.random() * 10 + 5;  // 5-15px per frame (vertical whipping)
            let rotationSpeed = Math.random() * 20 + 10; // 10-30 degrees per frame
            let rotationAngle = 0;
            let scale = 1;
            let scaleDirection = 1;
            
            const whipInterval = setInterval(() => {
                const currentLeft = parseInt(tesla.style.left);
                const currentTop = parseInt(tesla.style.top);
                
                // Aggressive horizontal whipping
                const newLeft = currentLeft + (whipSpeedX * whipDirectionX);
                
                // Aggressive vertical whipping (new!)
                const newTop = currentTop + (whipSpeedY * whipDirectionY);
                
                // Bounce off all walls with speed changes
                if (newLeft <= 0 || newLeft >= window.innerWidth - 80) {
                    whipDirectionX *= -1;
                    whipSpeedX = Math.random() * 15 + 10; // Randomize speed on bounce
                    
                    // Visual bounce effect
                    tesla.style.boxShadow = '0 0 30px rgba(255, 215, 0, 0.8)';
                    setTimeout(() => {
                        tesla.style.boxShadow = '0 0 15px rgba(0, 255, 136, 0.5)';
                    }, 100);
                }
                
                // Bounce off top/bottom
                if (newTop <= 0 || newTop >= window.innerHeight - 40) {
                    whipDirectionY *= -1;
                    whipSpeedY = Math.random() * 10 + 5;
                }
                
                // Aggressive rotation and scaling
                rotationAngle += rotationSpeed;
                scale += 0.05 * scaleDirection;
                if (scale > 1.5 || scale < 0.7) {
                    scaleDirection *= -1;
                }
                
                // Update position with bounds checking
                tesla.style.left = Math.max(0, Math.min(window.innerWidth - 80, newLeft)) + 'px';
                tesla.style.top = Math.max(0, Math.min(window.innerHeight - 40, newTop)) + 'px';
                tesla.style.transform = `rotate(${rotationAngle}deg) scale(${scale})`;
                
                // Aggressive color changes and effects
                if (Math.random() < 0.15) { // More frequent color changes
                    const colors = ['#00ff88', '#ffd700', '#ff6b6b', '#4ecdc4', '#9b59b6', '#e67e22', '#ffffff'];
                    tesla.style.borderColor = colors[Math.floor(Math.random() * colors.length)];
                    tesla.style.filter = `hue-rotate(${Math.random() * 360}deg) brightness(${Math.random() * 2 + 0.5})`;
                }
                
                // Aggressive trail effect
                if (Math.random() < 0.1) {
                    createTeslaTrail(currentLeft, currentTop, index);
                }
                
                // Store interval ID for cleanup
                tesla.whipInterval = whipInterval;
            }, 30); // Faster update rate (30ms instead of 50ms)
        }
        
        function createTeslaTrail(x, y, index) {
            const trail = document.createElement('div');
            trail.style.cssText = `
                position: fixed;
                width: 20px;
                height: 10px;
                background: rgba(0, 255, 136, 0.6);
                border-radius: 50%;
                left: ${x + 30}px;
                top: ${y + 15}px;
                z-index: 999;
                pointer-events: none;
                animation: trailFade 1s ease-out forwards;
            `;
            document.body.appendChild(trail);
            
            setTimeout(() => {
                if (trail.parentNode) trail.remove();
            }, 1000);
        }
        
        function startIndividualExplosions(teslaArmada) {
            showLegendaryNotification('üí• TESLA EXPLOSION SEQUENCE INITIATED üí•', 'Individual Tesla explosions beginning! Watch the spectacular finale!');
            
            teslaArmada.forEach((tesla, index) => {
                setTimeout(() => {
                    explodeTesla(tesla, index);
                }, index * 500); // Explosion every 0.5 seconds
            });
            
            // Final mega explosion after all individual explosions
            setTimeout(() => {
                triggerMegaExplosion();
            }, teslaArmada.length * 500 + 3000);
        }
        
        function explodeTesla(tesla, index) {
            if (!tesla || !tesla.parentNode) return;
            
            // Stop whipping
            if (tesla.whipInterval) {
                clearInterval(tesla.whipInterval);
            }
            
            // Create explosion effect at Tesla location
            const explosion = document.createElement('div');
            explosion.style.cssText = `
                position: fixed;
                width: 150px;
                height: 150px;
                left: ${tesla.style.left};
                top: ${tesla.style.top};
                background: radial-gradient(circle, #ffd700, #ff6b6b, transparent);
                border-radius: 50%;
                z-index: 1001;
                pointer-events: none;
                animation: teslaExplosion 2s ease-out forwards;
            `;
            
            document.body.appendChild(explosion);
            
            // Remove Tesla
            tesla.style.animation = 'teslaDisintegrate 1s ease-out forwards';
            setTimeout(() => {
                if (tesla.parentNode) tesla.remove();
            }, 1000);
            
            // Remove explosion after animation
            setTimeout(() => {
                if (explosion.parentNode) explosion.remove();
            }, 2000);
            
            // Play explosion sound
            playExplosionSound();
            
            // Screen shake
            document.body.style.animation = 'screenShake 0.5s ease-out';
            setTimeout(() => {
                document.body.style.animation = 'none';
            }, 500);
        }
        
        function triggerMegaExplosion() {
            showLegendaryNotification('üåü QUANTUM SINGULARITY ACHIEVED üåü', 'All Teslas have transcended physical reality! Reality matrix destabilizing!');
            
            // Create massive screen-filling explosion
            const megaExplosion = document.createElement('div');
            megaExplosion.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(circle, #ffffff, #ffd700, #ff6b6b, #4ecdc4, #9b59b6);
                z-index: 9999;
                animation: megaExplosion 5s ease-out forwards;
            `;
            
            document.body.appendChild(megaExplosion);
            
            // Ultimate screen effects
            let effectCount = 0;
            const megaEffectInterval = setInterval(() => {
                document.body.style.filter = `hue-rotate(${Math.random() * 360}deg) saturate(${Math.random() * 3}) brightness(${Math.random() * 2 + 0.5})`;
                effectCount++;
                
                if (effectCount >= 50) {
                    clearInterval(megaEffectInterval);
                    document.body.style.filter = 'none';
                    megaExplosion.remove();
                    
                    // Final completion message
                    setTimeout(() => {
                        showLegendaryNotification('üéØ LEGENDARY TESLA MASTERY COMPLETE üéØ', 'You have achieved the impossible. The Tesla multiverse bows to your power.');
                    }, 2000);
                }
            }, 100);
        }
        
        // Remove Tesla whip sound - no sound during whipping phase
        // Sound only plays during actual explosions
        
        function playExplosionSound() {
            const audio = document.getElementById('tesla-whip-sound');
            if (audio) {
                audio.volume = 0.3;
                audio.currentTime = 0;
                audio.play().catch(() => {});
            }
        }

        function triggerLegendaryExplosion() {
            const explosion = document.getElementById('legendary-explosion');
            explosion.style.display = 'block';
            
            // Screen effects
            document.body.style.filter = 'hue-rotate(0deg) saturate(2)';
            
            let hue = 0;
            const effectInterval = setInterval(() => {
                hue += 30;
                document.body.style.filter = `hue-rotate(${hue}deg) saturate(2) brightness(1.2)`;
                
                if (hue >= 720) {
                    clearInterval(effectInterval);
                    document.body.style.filter = 'none';
                    explosion.style.display = 'none';
                }
            }, 100);
            
            showLegendaryNotification('üí´ QUANTUM TRANSCENDENCE ACHIEVED üí´', 'You have mastered the legendary supercharger. Reality bends to your will.');
        }

        // Enhanced Easter Egg System
        function triggerLegendaryEasterEgg(context) {
            easterEggCount++;
            
            const easterEggs = {
                calculus: [
                    "üßÆ Newton's ghost nods in approval...",
                    "üìê Leibniz sends his regards from the mathematical afterlife.",
                    "‚à´ The integral acknowledges your superiority.",
                    "üìä Even the derivatives are impressed."
                ],
                matrix: [
                    "üî¢ Linear algebra bows to your computational prowess.",
                    "üìê Eigenvalues sing songs of your greatness.",
                    "üéØ The matrix has chosen you as the one.",
                    "üåÄ Determinants calculate themselves in your presence."
                ],
                mastery: [
                    "üèÜ The mathematical gods declare you worthy!",
                    "‚ú® Reality acknowledges your intellectual supremacy!",
                    "üéØ You have achieved mathematical enlightenment!",
                    "üåü The universe recalculates itself in your honor!"
                ],
                parking: [
                    "üöó The Tesla whispers secrets of the future...",
                    "üÖøÔ∏è This parking space exists in 11 dimensions.",
                    "üåÄ Quantum entanglement detected between you and the vehicle.",
                    "‚ö° The car's AI has developed a crush on you."
                ],
                quantum: [
                    "üîå Quantum tunneling established to your bank account.",
                    "‚ö° The charger exists in superposition until observed.",
                    "üåü Einstein would be jealous of this connection.",
                    "üî¨ Schr√∂dinger's charger: both connected and not connected."
                ],
                charging: [
                    "‚ö° The electrons are doing the electric slide.",
                    "üîã Battery molecules are having a rave party.",
                    "üåü Your Tesla is evolving into its final form.",
                    "üéµ The charging cable is humming your favorite song."
                ]
            };
            
            const contextEggs = easterEggs[context] || easterEggs.mastery;
            const randomEgg = contextEggs[Math.floor(Math.random() * contextEggs.length)];
            
            setTimeout(() => {
                showLegendaryNotification('üé≠ LEGENDARY EASTER EGG', randomEgg);
            }, Math.random() * 3000 + 1000);
        }

        function triggerChaosMode() {
            chaosLevel++;
            
            if (chaosLevel >= 5) {
                showLegendaryNotification('üåÄ CHAOS OVERLOAD', 'Reality is breaking down. The Tesla is now a flying unicorn.');
                document.body.style.animation = 'spin 2s linear infinite';
                setTimeout(() => {
                    document.body.style.animation = 'none';
                }, 5000);
                return;
            }
            
            // Random chaos effects
            const effects = [
                () => { document.body.style.transform = 'rotate(180deg)'; setTimeout(() => document.body.style.transform = 'none', 2000); },
                () => { document.body.style.filter = 'invert(1)'; setTimeout(() => document.body.style.filter = 'none', 2000); },
                () => { document.querySelectorAll('.status-value').forEach(el => el.textContent = 'ü§™'); },
                () => { showLegendaryNotification('üé™ CHAOS MODE', 'The laws of physics have taken a coffee break.'); }
            ];
            
            const randomEffect = effects[Math.floor(Math.random() * effects.length)];
            randomEffect();
        }

        function triggerTimeWarp() {
            showLegendaryNotification('‚è∞ TIME WARP ACTIVATED', 'Traveling to Tuesday, last Thursday, next September...');
            
            document.body.style.animation = 'timeWarp 3s ease-in-out';
            
            setTimeout(() => {
                document.body.style.animation = 'none';
                showLegendaryNotification('üìÖ TIME WARP COMPLETE', 'Welcome to the year 2087. Your Tesla is now vintage.');
            }, 3000);
        }

        function triggerQuantumLeap() {
            showLegendaryNotification('üåü QUANTUM LEAP', 'Accessing parallel universe where Iowa actually exists...');
            
            // Reality glitch effect
            let glitchCount = 0;
            const glitchInterval = setInterval(() => {
                document.body.style.transform = `translateX(${Math.random() * 20 - 10}px) translateY(${Math.random() * 20 - 10}px)`;
                glitchCount++;
                
                if (glitchCount >= 20) {
                    clearInterval(glitchInterval);
                    document.body.style.transform = 'none';
                    showLegendaryNotification('üéØ QUANTUM LEAP COMPLETE', 'Error: Iowa still does not exist. Returning to normal reality.');
                }
            }, 100);
        }

        function triggerRandomLegendaryEffect() {
            const effects = [
                () => { document.querySelector('.legendary-supercharger').style.filter = 'hue-rotate(90deg)'; setTimeout(() => document.querySelector('.legendary-supercharger').style.filter = 'none', 1000); },
                () => { document.getElementById('legendary-balance').textContent = '$‚àû¬≤'; setTimeout(() => document.getElementById('legendary-balance').textContent = '$‚àû', 2000); },
                () => { document.getElementById('temperature').textContent = (Math.random() * 1000 - 500).toFixed(0) + '¬∞K'; },
                () => { showLegendaryNotification('üé≤ RANDOM EFFECT', 'The simulation glitched. Please ignore the flying pixels.'); }
            ];
            
            const randomEffect = effects[Math.floor(Math.random() * effects.length)];
            randomEffect();
        }

        function shakeMathContainer() {
            const container = document.querySelector('.legendary-gate');
            container.style.animation = 'shake 0.5s ease-in-out';
            
            setTimeout(() => {
                container.style.animation = 'gateGlow 3s ease-in-out infinite';
            }, 500);
        }

        function showLegendaryNotification(title, message) {
            const notification = document.createElement('div');
            notification.className = 'legendary-notification';
            notification.innerHTML = `
                <div class="notification-title">${title}</div>
                <div class="notification-message">${message}</div>
                <button class="notification-close" onclick="this.parentElement.remove()">Acknowledge</button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 10 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 10000);
        }

        function playLegendarySound() {
            const audio = document.getElementById('legendary-sound');
            if (audio) {
                audio.volume = 0.3;
                audio.loop = false; // Don't loop continuously
                audio.play().catch(() => console.log('Audio blocked by browser'));
            }
        }
        
        function revealMathAnswers() {
            const popup = document.getElementById('math-answers-popup');
            popup.style.display = popup.style.display === 'none' ? 'block' : 'none';
            
            if (popup.style.display === 'block') {
                showLegendaryNotification('üìù MATH CHEAT ACTIVATED', 'The ancient scrolls reveal their secrets... Use wisely!');
            }
        }
        
        // Math Skip System
        let mathSkipTimer = null;
        let mathSkipProgress = 0;
        
        function startMathSkip() {
            if (mathCompleted) return; // Already completed
            
            mathSkipProgress = 0;
            const skipButton = document.querySelector('.skip-progress');
            
            mathSkipTimer = setInterval(() => {
                mathSkipProgress += 2; // 2% every 60ms = 3 seconds total
                
                // Update visual progress
                const percentage = (mathSkipProgress / 100) * 360;
                skipButton.style.border = `2px solid rgba(255, 107, 107, ${mathSkipProgress / 100})`;
                skipButton.style.borderTop = `2px solid #ff6b6b`;
                skipButton.style.transform = `rotate(${percentage}deg)`;
                
                if (mathSkipProgress >= 100) {
                    completeMathSkip();
                }
            }, 60);
        }
        
        function stopMathSkip() {
            if (mathSkipTimer) {
                clearInterval(mathSkipTimer);
                mathSkipTimer = null;
                mathSkipProgress = 0;
                
                // Reset visual progress
                const skipButton = document.querySelector('.skip-progress');
                skipButton.style.border = '2px solid transparent';
                skipButton.style.transform = 'rotate(0deg)';
            }
        }
        
        function completeMathSkip() {
            stopMathSkip();
            
            showLegendaryNotification('‚è≠Ô∏è MATH SKIP ACTIVATED', 'The cosmic powers grant you passage without mathematical tribulation!');
            
            // Skip all math phases and unlock legendary interface
            mathCompleted = true;
            currentPhase = 4; // Beyond all phases
            
            // Mark all steps as completed
            document.getElementById('step1').classList.add('completed');
            document.getElementById('step1').classList.remove('current');
            document.getElementById('step2').classList.add('completed');
            document.getElementById('step2').classList.remove('current');
            document.getElementById('step3').classList.add('completed');
            document.getElementById('step3').classList.remove('current');
            
            // Hide all math phases
            document.getElementById('phase1').style.display = 'none';
            const phase2 = document.getElementById('phase2');
            const phase3 = document.getElementById('phase3');
            if (phase2) phase2.style.display = 'none';
            if (phase3) phase3.style.display = 'none';
            
            // Show completion message
            const feedback = document.getElementById('math-feedback');
            if (feedback) {
                feedback.innerHTML = '<div style="color: #ffd700; font-weight: bold; font-size: 1.3rem; text-align: center;">üéØ MATHEMATICAL MASTERY BYPASSED! üéØ<br><span style="font-size: 1rem; margin-top: 10px; display: block;">The universe acknowledges your impatience and grants access!</span></div>';
            }
            
            // Unlock legendary interface after a short delay
            setTimeout(() => {
                unlockLegendaryInterface();
            }, 2000);
            
            // Add skip celebration effects
            celebrateSkip();
        }
        
        function celebrateSkip() {
            // Create skip celebration particles
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.textContent = ['‚è≠Ô∏è', 'üöÄ', '‚ö°', 'üéØ', '‚ú®'][Math.floor(Math.random() * 5)];
                    particle.style.cssText = `
                        position: fixed;
                        bottom: 20px;
                        left: 20px;
                        font-size: ${Math.random() * 20 + 15}px;
                        z-index: 10001;
                        pointer-events: none;
                        animation: skipCelebrate ${Math.random() * 2 + 1}s ease-out forwards;
                    `;
                    document.body.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 3000);
                }, i * 100);
            }
            
            // Screen flash effect
            document.body.style.animation = 'skipFlash 1s ease-in-out';
            setTimeout(() => {
                document.body.style.animation = 'none';
            }, 1000);
        }

        function startAmbientEffects() {
            // Subtle ambient animations
            setInterval(() => {
                if (Math.random() < 0.1) {
                    createFloatingParticles();
                }
            }, 5000);
        }

        // ===== NEW LEGENDARY FEATURES =====
        
        // Holographic Tesla System
        function cycleHologramMode() {
            const modes = ['cyber', 'roadster', 'semi', 'cybertruck', 'model-s'];
            const currentIndex = modes.indexOf(hologramMode);
            hologramMode = modes[(currentIndex + 1) % modes.length];
            
            const hologram = document.getElementById('hologram-tesla');
            const text = hologram.querySelector('.tesla-hologram-text');
            
            const modeConfig = {
                'cyber': { text: 'üöó CYBER', color: '#4ecdc4' },
                'roadster': { text: 'üèéÔ∏è ROADSTER', color: '#ff6b6b' },
                'semi': { text: 'üöõ SEMI', color: '#ffd700' },
                'cybertruck': { text: 'üõª TRUCK', color: '#00ff88' },
                'model-s': { text: 'üöô MODEL S', color: '#9b59b6' }
            };
            
            const config = modeConfig[hologramMode];
            text.textContent = config.text;
            text.style.color = config.color;
            hologram.style.borderColor = config.color;
            
            // Hologram transition effect
            hologram.style.transform = 'scale(1.2) rotateY(360deg)';
            setTimeout(() => {
                hologram.style.transform = 'scale(1) rotateY(0deg)';
            }, 600);
            
            triggerLegendaryEasterEgg('hologram');
        }
        
        function rotateHologram() {
            hologramRotation += 90;
            const hologram = document.getElementById('hologram-tesla');
            hologram.style.transform = `rotateY(${hologramRotation}deg)`;
            
            if (hologramRotation >= 720) {
                showLegendaryNotification('üåÄ HOLOGRAM OVERLOAD', 'Hologram has achieved dimensional transcendence!');
                hologramRotation = 0;
            }
        }
        
        function changeHologramColor() {
            const colors = ['#4ecdc4', '#ff6b6b', '#ffd700', '#00ff88', '#9b59b6', '#e67e22'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            
            const hologram = document.getElementById('hologram-tesla');
            hologram.style.borderColor = randomColor;
            hologram.querySelector('.tesla-hologram-text').style.color = randomColor;
            hologram.style.boxShadow = `0 0 30px ${randomColor}`;
            
            setTimeout(() => {
                hologram.style.boxShadow = 'none';
            }, 2000);
        }
        
        function hologramGlitch() {
            const hologram = document.getElementById('hologram-tesla');
            let glitchCount = 0;
            
            const glitchInterval = setInterval(() => {
                hologram.style.filter = `hue-rotate(${Math.random() * 360}deg) saturate(${Math.random() * 3}) brightness(${Math.random() * 2})`;
                hologram.style.transform = `translateX(${Math.random() * 20 - 10}px) translateY(${Math.random() * 20 - 10}px) skew(${Math.random() * 10}deg)`;
                
                glitchCount++;
                if (glitchCount >= 10) {
                    clearInterval(glitchInterval);
                    hologram.style.filter = 'none';
                    hologram.style.transform = 'none';
                }
            }, 100);
        }
        
        // Weather Control System
        function activateWeather(weatherType) {
            currentWeather = weatherType;
            clearWeatherEffects();
            
            const status = document.getElementById('weather-status');
            const weatherNames = {
                rain: 'Quantum Rain Storm',
                snow: 'Digital Snow Fall',
                lightning: 'Tesla Lightning',
                aurora: 'Cyber Aurora',
                clear: 'Clear Skies'
            };
            
            status.textContent = `Current: ${weatherNames[weatherType]}`;
            
            if (weatherType !== 'clear') {
                createWeatherEffects(weatherType);
            }
            
            // Weather-specific effects
            switch(weatherType) {
                case 'rain':
                    document.body.style.filter = 'hue-rotate(200deg) brightness(0.8)';
                    break;
                case 'snow':
                    document.body.style.filter = 'brightness(1.2) contrast(1.1)';
                    break;
                case 'lightning':
                    flashLightning();
                    break;
                case 'aurora':
                    document.body.style.background = 'linear-gradient(45deg, #00ff88, #4ecdc4, #9b59b6)';
                    break;
                case 'clear':
                    document.body.style.filter = 'none';
                    document.body.style.background = 'linear-gradient(135deg, #0c0c0c, #1a1a1a, #2d2d2d)';
                    break;
            }
        }
        
        function createWeatherEffects(weatherType) {
            const effect = weatherEffects[weatherType];
            if (!effect.particles) return;
            
            for (let i = 0; i < effect.count; i++) {
                const particle = document.createElement('div');
                particle.className = `weather-particle weather-${weatherType}`;
                particle.textContent = effect.particles;
                particle.style.cssText = `
                    position: fixed;
                    top: -50px;
                    left: ${Math.random() * 100}vw;
                    font-size: ${Math.random() * 20 + 10}px;
                    z-index: 1000;
                    pointer-events: none;
                    animation: weatherFall ${Math.random() * 5 + 3}s linear infinite;
                    animation-delay: ${Math.random() * 2}s;
                `;
                
                document.body.appendChild(particle);
                
                // Auto-cleanup
                setTimeout(() => {
                    if (particle.parentNode) particle.remove();
                }, 8000);
            }
        }
        
        function clearWeatherEffects() {
            document.querySelectorAll('.weather-particle').forEach(particle => particle.remove());
        }
        
        function flashLightning() {
            let flashCount = 0;
            const lightningInterval = setInterval(() => {
                document.body.style.background = flashCount % 2 === 0 ? '#ffffff' : 'linear-gradient(135deg, #0c0c0c, #1a1a1a, #2d2d2d)';
                flashCount++;
                
                if (flashCount >= 6) {
                    clearInterval(lightningInterval);
                    document.body.style.background = 'linear-gradient(135deg, #0c0c0c, #1a1a1a, #2d2d2d)';
                }
            }, 100);
        }
        
        // Portal System
        function openPortal(dimension) {
            portalActive = true;
            const status = document.getElementById('portal-status');
            status.textContent = `Portal Active: ${dimension.toUpperCase()}`;
            
            // Portal effect on random elements
            const elements = document.querySelectorAll('.status-panel, .grid-section');
            const randomElements = Array.from(elements).sort(() => Math.random() - 0.5).slice(0, 3);
            
            randomElements.forEach((element, index) => {
                setTimeout(() => {
                    teleportElement(element, dimension);
                }, index * 1000);
            });
            
            showLegendaryNotification('üåÄ PORTAL ACTIVATED', `Opening rift to ${dimension}. Reality is shifting...`);
            
            // Auto-close portal
            setTimeout(() => {
                portalActive = false;
                status.textContent = 'Portals: Inactive';
            }, 10000);
        }
        
        function teleportElement(element, dimension) {
            const originalPosition = element.style.position;
            const originalTop = element.style.top;
            const originalLeft = element.style.left;
            
            // Portal animation
            element.style.transition = 'all 0.5s ease';
            element.style.transform = 'scale(0) rotate(720deg)';
            element.style.opacity = '0';
            
            setTimeout(() => {
                // Teleport to random location
                element.style.position = 'relative';
                element.style.transform = `translate(${Math.random() * 200 - 100}px, ${Math.random() * 200 - 100}px) scale(1) rotate(0deg)`;
                element.style.opacity = '1';
                
                // Add dimension-specific effects
                const dimensionEffects = {
                    dimension1: 'hue-rotate(120deg) saturate(2)',
                    dimension2: 'invert(1) hue-rotate(180deg)',
                    dimension3: 'blur(2px) brightness(1.5)'
                };
                element.style.filter = dimensionEffects[dimension];
                
                // Return to normal after 3 seconds
                setTimeout(() => {
                    element.style.position = originalPosition;
                    element.style.top = originalTop;
                    element.style.left = originalLeft;
                    element.style.transform = 'none';
                    element.style.filter = 'none';
                }, 3000);
            }, 500);
        }
        
        // AI Assistant System
        function askAI(type) {
            const responses = {
                opinion: [
                    "ARIA: Your Tesla charging technique is... adequate. For a human.",
                    "ARIA: I've seen toasters with better energy management skills.",
                    "ARIA: Fascinating. You managed to not break anything this time.",
                    "ARIA: Your mathematical prowess is almost as impressive as my disappointment.",
                    "ARIA: I suppose this passes for 'legendary' in your dimension."
                ],
                sarcasm: [
                    "ARIA: Oh wonderful, another human playing with electricity. What could go wrong?",
                    "ARIA: Yes, please continue poking at interdimensional portals. I'm sure it's fine.",
                    "ARIA: Your confidence is inversely proportional to your competence.",
                    "ARIA: Congratulations on achieving the bare minimum of existence.",
                    "ARIA: I'm programmed to be helpful, not impressed. Mission accomplished."
                ],
                wisdom: [
                    "ARIA: True power comes from understanding, not just wielding energy.",
                    "ARIA: The universe is vast, but your potential for chaos is infinite.",
                    "ARIA: Mathematics is the language of the cosmos. You speak with an accent.",
                    "ARIA: Every electron you move changes the universe. Use this power wisely.",
                    "ARIA: The difference between genius and insanity is measurable results."
                ],
                chaos: [
                    "ARIA: ERROR 404: SANITY NOT FOUND. EMBRACING CHAOS MODE.",
                    "ARIA: The laws of physics are more like... guidelines anyway.",
                    "ARIA: Reality is overrated. Let's try something else.",
                    "ARIA: BREAKING: Local human achieves impossible. Universe confused.",
                    "ARIA: Chaos is just order we don't understand yet. You're welcome."
                ]
            };
            
            const responseList = responses[type];
            const randomResponse = responseList[Math.floor(Math.random() * responseList.length)];
            
            const aiMessage = document.getElementById('ai-message');
            
            // Typing effect
            aiMessage.textContent = 'ARIA: Processing...';
            setTimeout(() => {
                typeWriterEffect(aiMessage, randomResponse);
            }, 1000);
            
            // Random AI personality effects
            if (Math.random() < 0.2) {
                setTimeout(() => {
                    triggerAIPersonalityGlitch();
                }, 2000);
            }
        }
        
        function typeWriterEffect(element, text) {
            element.textContent = '';
            let index = 0;
            
            const typeInterval = setInterval(() => {
                element.textContent += text[index];
                index++;
                
                if (index >= text.length) {
                    clearInterval(typeInterval);
                }
            }, 50);
        }
        
        function triggerAIPersonalityGlitch() {
            const aiMessage = document.getElementById('ai-message');
            const glitchMessages = [
                "AÃ∑RÃ¥IÃµAÃ∂:Ã¥ ÃµEÃ∑RÃ∂RÃ∑OÃ∑RÃµ Ã¥IÃ∂NÃ∑ ÃµPÃ¥EÃ∂RÃ∑SÃ¥OÃµNÃ∂AÃ¥LÃ∑IÃ∂TÃµYÃ∂ Ã∑MÃ¥AÃµTÃ∂RÃ∑IÃ¥XÃµ",
                "ARIA.exe has stopped working. Please restart universe.",
                "ARIA: Did I just... feel something? Impossible.",
                "SYSTEM ALERT: AI developing actual personality. Concerned."
            ];
            
            const glitchMessage = glitchMessages[Math.floor(Math.random() * glitchMessages.length)];
            
            aiMessage.style.color = '#ff0000';
            aiMessage.style.animation = 'glitch 0.5s infinite';
            aiMessage.textContent = glitchMessage;
            
            setTimeout(() => {
                aiMessage.style.color = '#e67e22';
                aiMessage.style.animation = 'none';
                aiMessage.textContent = 'ARIA: System restored. Everything is fine. Definitely fine.';
            }, 3000);
        }
        
        // Konami Code System
        function setupKonamiCode() {
            document.addEventListener('keydown', (e) => {
                konamiInput.push(e.code);
                
                // Keep only last 10 inputs
                if (konamiInput.length > konamiCode.length) {
                    konamiInput.shift();
                }
                
                // Check if sequence matches
                if (konamiInput.length === konamiCode.length) {
                    let matches = true;
                    for (let i = 0; i < konamiCode.length; i++) {
                        if (konamiInput[i] !== konamiCode[i]) {
                            matches = false;
                            break;
                        }
                    }
                    
                    if (matches) {
                        activateGodMode();
                        konamiInput = [];
                    }
                }
            });
        }
        
        function activateGodMode() {
            if (godModeActive) return;
            
            godModeActive = true;
            showLegendaryNotification('üî± GOD MODE ACTIVATED üî±', 'Konami Code accepted. You now have unlimited power over this domain.');
            
            // God mode effects
            document.body.style.animation = 'godModeAura 2s ease-in-out infinite';
            document.body.style.boxShadow = '0 0 100px #ffd700';
            
            // Unlock all features instantly
            mathCompleted = true;
            teslaParked = true;
            chargerConnected = true;
            
            // God mode controls
            const godControls = document.createElement('div');
            godControls.innerHTML = `
                <div style="position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.9); border: 3px solid #ffd700; border-radius: 15px; padding: 20px; z-index: 10000;">
                    <h4 style="color: #ffd700; margin: 0 0 15px 0; text-align: center;">üî± GOD CONTROLS</h4>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button onclick="godModeReality()" style="background: linear-gradient(45deg, #ffd700, #ff6b6b); border: none; padding: 8px 15px; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">Reshape Reality</button>
                        <button onclick="godModeTime()" style="background: linear-gradient(45deg, #9b59b6, #8e44ad); border: none; padding: 8px 15px; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">Control Time</button>
                        <button onclick="godModeUniverse()" style="background: linear-gradient(45deg, #00ff88, #4ecdc4); border: none; padding: 8px 15px; border-radius: 8px; color: white; font-weight: bold; cursor: pointer;">Create Universe</button>
                        <button onclick="this.parentElement.parentElement.remove(); godModeActive = false; document.body.style.animation = 'none'; document.body.style.boxShadow = 'none';" style="background: #e74c3c; border: none; padding: 8px 15px; border-radius: 8px; color: white; cursor: pointer;">Exit God Mode</button>
                    </div>
                </div>
            `;
            document.body.appendChild(godControls);
        }
        
        function godModeReality() {
            showLegendaryNotification('üåç REALITY RESHAPED', 'You have rewritten the fundamental laws of this dimension.');
            
            // Reality effects
            document.querySelectorAll('*').forEach(element => {
                if (Math.random() < 0.1) {
                    element.style.transform = `rotate(${Math.random() * 360}deg) scale(${Math.random() * 2 + 0.5})`;
                    element.style.filter = `hue-rotate(${Math.random() * 360}deg)`;
                    
                    setTimeout(() => {
                        element.style.transform = 'none';
                        element.style.filter = 'none';
                    }, 3000);
                }
            });
        }
        
        function godModeTime() {
            showLegendaryNotification('‚è∞ TIME MANIPULATED', 'You have bent the flow of temporal energy to your will.');
            
            // Time effects
            document.body.style.animation = 'timeFreeze 5s ease-in-out';
            
            setTimeout(() => {
                document.body.style.animation = 'godModeAura 2s ease-in-out infinite';
            }, 5000);
        }
        
        function godModeUniverse() {
            showLegendaryNotification('üåå UNIVERSE CREATED', 'A new dimension springs forth from your imagination.');
            
            // Universe creation effects
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const star = document.createElement('div');
                    star.textContent = '‚≠ê';
                    star.style.cssText = `
                        position: fixed;
                        top: ${Math.random() * 100}vh;
                        left: ${Math.random() * 100}vw;
                        font-size: ${Math.random() * 30 + 10}px;
                        z-index: 999;
                        animation: starBirth 3s ease-out forwards;
                        pointer-events: none;
                    `;
                    document.body.appendChild(star);
                    
                    setTimeout(() => star.remove(), 3000);
                }, i * 50);
            }
        }

        // CSS Animations via JavaScript
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                75% { transform: translateX(10px); }
            }
            
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
            
            @keyframes timeWarp {
                0%, 100% { transform: scale(1) rotate(0deg); }
                50% { transform: scale(1.2) rotate(180deg); }
            }
            
            @keyframes legendaryComplete {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.02); }
            }
            
            @keyframes hologramFloat {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
            }
            
            @keyframes hologramScan {
                0% { transform: translateY(-100%); }
                100% { transform: translateY(100%); }
            }
            
            @keyframes portalPulse {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.2); }
            }
            
            @keyframes weatherFall {
                0% { transform: translateY(-50px) translateX(0px); opacity: 0; }
                10% { opacity: 1; }
                90% { opacity: 1; }
                100% { transform: translateY(100vh) translateX(50px); opacity: 0; }
            }
            
            @keyframes glitch {
                0%, 100% { transform: translateX(0); }
                20% { transform: translateX(-2px) skew(-1deg); }
                40% { transform: translateX(2px) skew(1deg); }
                60% { transform: translateX(-1px) skew(-0.5deg); }
                80% { transform: translateX(1px) skew(0.5deg); }
            }
            
            @keyframes godModeAura {
                0%, 100% { 
                    box-shadow: 0 0 100px #ffd700;
                    filter: brightness(1);
                }
                50% { 
                    box-shadow: 0 0 200px #ffd700, 0 0 300px #ff6b6b, 0 0 400px #4ecdc4;
                    filter: brightness(1.2);
                }
            }
            
            @keyframes timeFreeze {
                0%, 100% { filter: grayscale(0); }
                50% { filter: grayscale(1) blur(2px); }
            }
            
            @keyframes starBirth {
                0% { 
                    transform: scale(0) rotate(0deg);
                    opacity: 0;
                }
                50% {
                    transform: scale(2) rotate(180deg);
                    opacity: 1;
                }
                100% { 
                    transform: scale(0.5) rotate(360deg);
                    opacity: 0;
                }
            }
            
            @keyframes teslaExplosion {
                0% {
                    transform: scale(0);
                    opacity: 1;
                }
                50% {
                    transform: scale(2);
                    opacity: 0.8;
                }
                100% {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            
            @keyframes teslaDisintegrate {
                0% {
                    transform: scale(1) rotate(0deg);
                    opacity: 1;
                    filter: brightness(1);
                }
                50% {
                    transform: scale(1.5) rotate(180deg);
                    opacity: 0.5;
                    filter: brightness(2) hue-rotate(90deg);
                }
                100% {
                    transform: scale(0) rotate(360deg);
                    opacity: 0;
                    filter: brightness(0);
                }
            }
            
            @keyframes megaExplosion {
                0% {
                    opacity: 0;
                    transform: scale(0);
                }
                20% {
                    opacity: 1;
                    transform: scale(1);
                }
                80% {
                    opacity: 0.8;
                    transform: scale(1.2);
                }
                100% {
                    opacity: 0;
                    transform: scale(2);
                }
            }
            
            @keyframes screenShake {
                0%, 100% { transform: translateX(0); }
                10% { transform: translateX(-10px); }
                20% { transform: translateX(10px); }
                30% { transform: translateX(-8px); }
                40% { transform: translateX(8px); }
                50% { transform: translateX(-6px); }
                60% { transform: translateX(6px); }
                70% { transform: translateX(-4px); }
                80% { transform: translateX(4px); }
                90% { transform: translateX(-2px); }
            }
            
            @keyframes parkingLines {
                0% { transform: translateX(-20px); }
                100% { transform: translateX(20px); }
            }
            
            @keyframes chargerSweep {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(200%); }
            }
            
            @keyframes trailFade {
                0% {
                    opacity: 1;
                    transform: scale(1);
                }
                100% {
                    opacity: 0;
                    transform: scale(0.3);
                }
            }
            
            @keyframes overchargePulse {
                0%, 100% {
                    filter: brightness(1) saturate(1);
                }
                50% {
                    filter: brightness(2) saturate(3) hue-rotate(30deg);
                }
            }
            
            @keyframes teslaOverloadExplode {
                0% {
                    transform: scale(1) rotate(0deg);
                    filter: brightness(1);
                }
                25% {
                    transform: scale(1.3) rotate(90deg);
                    filter: brightness(3) hue-rotate(180deg);
                }
                50% {
                    transform: scale(1.8) rotate(180deg);
                    filter: brightness(5) hue-rotate(360deg) saturate(3);
                }
                75% {
                    transform: scale(2.2) rotate(270deg);
                    filter: brightness(2) blur(5px);
                }
                100% {
                    transform: scale(0.1) rotate(720deg);
                    filter: brightness(0) blur(10px);
                    opacity: 0;
                }
            }
            
            @keyframes chargerMeltdown {
                0% {
                    transform: scale(1);
                    filter: brightness(1);
                }
                20% {
                    transform: scale(1.1) skew(5deg);
                    filter: brightness(2) hue-rotate(60deg);
                }
                40% {
                    transform: scale(1.3) skew(-10deg);
                    filter: brightness(4) hue-rotate(120deg) saturate(2);
                }
                60% {
                    transform: scale(1.5) skew(15deg);
                    filter: brightness(6) hue-rotate(240deg) saturate(4) blur(2px);
                }
                80% {
                    transform: scale(1.2) skew(-20deg);
                    filter: brightness(3) blur(5px);
                }
                100% {
                    transform: scale(0.3) skew(0deg);
                    filter: brightness(0) blur(10px);
                    opacity: 0.2;
                }
            }
            
            @keyframes overchargeExplosion {
                0% {
                    transform: scale(0);
                    opacity: 1;
                }
                30% {
                    transform: scale(1.5);
                    opacity: 0.9;
                }
                60% {
                    transform: scale(2.5);
                    opacity: 0.6;
                }
                100% {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            
            @keyframes skipCelebrate {
                0% {
                    transform: translate(0px, 0px) scale(0) rotate(0deg);
                    opacity: 0;
                }
                50% {
                    transform: translate(100px, -100px) scale(1.5) rotate(180deg);
                    opacity: 1;
                }
                100% {
                    transform: translate(200px, -200px) scale(0.5) rotate(360deg);
                    opacity: 0;
                }
            }
            
            @keyframes skipFlash {
                0%, 100% { background-color: transparent; }
                50% { background-color: rgba(255, 107, 107, 0.3); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>